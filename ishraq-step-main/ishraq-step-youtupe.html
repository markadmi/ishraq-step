<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ishraq Step - Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ù…Ø±Ø¦ÙŠØ©</title>
<link rel="stylesheet" href="css/video.css">
<link rel="icon" href="icon.png" type="image/x-icon">
<style>
  .sections {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 10px;
    padding: 15px;
  }
  /* Loader */
  .loader {
    display: none;
    align-items: center;
    justify-content: center;
    gap:10px;
    padding: 18px;
    background: rgba(255,255,255,0.9);
    border-radius: 10px;
    color: #333;
    font-weight: 700;
    margin-bottom: 12px;
  }
  .spinner {
    width:18px;
    height:18px;
    border:3px solid #ddd;
    border-top-color:#4caf50;
    border-radius:50%;
    animation: spin 1s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  .section-card {
    background: linear-gradient(135deg, #4caf50, #00eeff);
    color: white;
    border-radius: 14px;
    text-align: center;
    padding: 18px;
    cursor: pointer;
    transition: transform 0.25s ease, box-shadow 0.25s ease;
    font-size: 18px;
    font-weight: bold;
    box-shadow: 0 4px 10px rgba(76, 175, 80, 0.4);
  }

  .section-card:hover {
    transform: translateY(-6px) scale(1.03);
    box-shadow: 0 8px 18px rgba(76, 175, 80, 0.6);
  }

  #videos-container {
    display: none;
    padding: 15px;
  }

  .back-btn {
    background: #4caf50;
    color: white;
    padding: 8px 15px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    margin-bottom: 15px;
  }

  .video {
    margin-bottom: 20px;
    text-align: center;
  }

  .video iframe {
    width: 100%;
    max-width: 600px;
    height: 315px;
    border: none;
    border-radius: 10px;
  }
</style>
   <!--ads-->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4496926993663116"
     crossorigin="anonymous">
      </script>
</head>
 <body>

<header>ğŸ“š Ishraq Step - Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ù…Ø±Ø¦ÙŠØ©</header>

<!-- ğŸ§­ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø³Ø¨Ø¹Ø© -->
<div id="sections-container" class="sections">
  <div class="section-card" data-type="Ù…Ø§Ø« 0">ğŸ§® Ù…Ø§Ø« 0</div>
  <div class="section-card" data-type="Ù…Ø§Ø« 1">ğŸ§® Ù…Ø§Ø« 1</div>
  <div class="section-card" data-type="Ø§Ù†Ø¬Ù„ÙŠØ²ÙŠ">ğŸ‡¬ğŸ‡§ Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ</div>
  <div class="section-card" data-type="Ø¯ÙˆØ§Ø¦Ø± ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©">ğŸ”Œ Ø¯ÙˆØ§Ø¦Ø± ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©</div>
  <div class="section-card" data-type="Ø§Ø®Ù„Ø§Ù‚ÙŠØ§Øª Ø§Ù„Ù…Ù‡Ù†Ù‡">âš–ï¸ Ø£Ø®Ù„Ø§Ù‚ÙŠØ§Øª Ø§Ù„Ù…Ù‡Ù†Ø©</div>
  <div class="section-card" data-type="Ù…Ù‚Ø¯Ù…Ø© Ø­Ø§Ø³Ø¨ Ø§Ù„ÙŠ">ğŸ’» Ù…Ù‚Ø¯Ù…Ø© Ø­Ø§Ø³Ø¨ Ø¢Ù„ÙŠ</div>
  <div class="section-card" data-type="ÙƒÙˆØ±Ø³Ø§Øª Ø§Ø®Ø±Ù‰">ğŸ§  ÙƒÙˆØ±Ø³Ø§Øª Ø£Ø®Ø±Ù‰</div>
</div>

<!-- ğŸ¥ Ù‚Ø³Ù… Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª -->
<div id="videos-container">
  <button class="back-btn">â¬…ï¸ Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</button>
  <h2 id="section-title"></h2>

  <!-- loader: ÙŠØ¸Ù‡Ø± Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª -->
  <div id="loader" class="loader"><div class="spinner" aria-hidden="true"></div><div>Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...</div></div>

  <!-- Ø¬Ø¯ÙŠØ¯: Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ÙØ±Ø¹ÙŠØ© -->
  <div id="subsections-list" style="display:none; padding:12px; gap:10px;"></div>

  <div id="videos-list"></div>
</div>

<footer>Â© 2025 Ishraq Step â€“ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</footer>

<!-- Firebase -->
 <script type="module">
  import { db } from './chat/js/fb.js';
  import { ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

  const sectionsContainer = document.getElementById('sections-container');
  const videosContainer = document.getElementById('videos-container');
  const videosList = document.getElementById('videos-list');
  const sectionTitle = document.getElementById('section-title');
  const backBtn = document.querySelector('.back-btn');
  const subsectionsList = document.getElementById('subsections-list'); // Ø¬Ø¯ÙŠØ¯

  let coursesData = {};

  // ğŸ§  ØªØ­Ù…ÙŠÙ„ ÙƒÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© Ù…Ù† Firebase
  onValue(ref(db, 'courses'), snapshot => {
    coursesData = snapshot.val() || {};
  });

  // ğŸ“Œ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ù‚Ø³Ù…
  document.querySelectorAll('.section-card').forEach(card => {
    card.addEventListener('click', () => {
      const type = card.dataset.type;
      showSectionVideos(type);
    });
  });

  // ğŸŸ¢ Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù‚Ø³Ù… Ù…Ø¹ÙŠÙ†
  function showSectionVideos(type) {
    sectionsContainer.style.display = 'none';
    videosContainer.style.display = 'block';
    sectionTitle.textContent = `ğŸ“ ${type}`;
    videosList.innerHTML = '';
    subsectionsList.innerHTML = '';
    subsectionsList.style.display = 'none';
    showLoader(true);

    requestAnimationFrame(() => {
      const all = Object.values(coursesData || {});
      const filtered = all.filter(item => item.type === type);

      if (filtered.length === 0) {
        videosList.innerHTML = '<p>ğŸš§ Ù„Ø§ ØªÙˆØ¬Ø¯ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ø¨Ø¹Ø¯ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù…</p>';
        showLoader(false);
        return;
      }

      // Ø¬Ù…Ø¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ÙØ±Ø¹ÙŠØ© (subsection)
      const subs = Array.from(new Set(filtered.map(v => (v.subsection||'Ø¨Ø¯ÙˆÙ† Ù‚Ø³Ù… ÙØ±Ø¹ÙŠ').trim())));

      if(subs.length > 1 || (subs.length===1 && subs[0] !== '')) {
        // Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„ÙØ±Ø¹ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹
        subsectionsList.style.display = 'flex';
        subsectionsList.style.flexWrap = 'wrap';
        subsectionsList.style.gap = '10px';
        // Ø²Ø± Ù„Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„
        const allBtn = document.createElement('div');
        allBtn.className = 'section-card';
        allBtn.textContent = 'ğŸŸ¢ Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„';
        allBtn.addEventListener('click', ()=> renderVideos(filtered));
        subsectionsList.appendChild(allBtn);

        subs.forEach(s => {
          const label = s || 'Ø¨Ø¯ÙˆÙ† Ù‚Ø³Ù… ÙØ±Ø¹ÙŠ';
          const card = document.createElement('div');
          card.className = 'section-card';
          card.textContent = label;
          card.addEventListener('click', ()=> {
            const items = filtered.filter(v => ((v.subsection||'').trim() || 'Ø¨Ø¯ÙˆÙ† Ù‚Ø³Ù… ÙØ±Ø¹ÙŠ') === label);
            renderVideos(items);
          });
          subsectionsList.appendChild(card);
        });

        // Ø§ÙØªØ±Ø§Ø¶ÙŠÙ‹Ø§ Ù†Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„
        renderVideos(filtered);
        showLoader(false);
        return;
      }

      // Ø­Ø§Ù„Ø© ÙˆØ¬ÙˆØ¯ Ù‚Ø³Ù… ÙØ±Ø¹ÙŠ ÙˆØ§Ø­Ø¯ ÙÙ‚Ø· Ø£Ùˆ Ù„Ø§ Ø£Ù‚Ø³Ø§Ù… ÙØ±Ø¹ÙŠØ©
      renderVideos(filtered);
      showLoader(false);
    });
  }

  function renderVideos(list){
    videosList.innerHTML = '';
    list.forEach(video => {
      const div = document.createElement('div');
      div.className = 'video';
      const subLabel = (video.subsection || '').trim();
      div.innerHTML = `
        <iframe src="${video.url}" allowfullscreen></iframe>
        <h2>${video.title}</h2>
        ${ subLabel ? `<h3 style="color:#4caf50;">${subLabel}</h3>` : '' }
        <p>${video.description}</p>
      `;
      videosList.appendChild(div);
    });
  }

  // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù€ loader
  function showLoader(show){
    const loader = document.getElementById('loader');
    if(!loader) return;
    loader.style.display = show ? 'flex' : 'none';
  }

  // ğŸ”™ Ø²Ø± Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
  backBtn.addEventListener('click', () => {
    videosContainer.style.display = 'none';
    sectionsContainer.style.display = 'grid';
    sectionTitle.textContent = '';
    videosList.innerHTML = '';
    showLoader(false);
  });
 </script>

 </body>
</html>